# SwarmでのOverlay Networkについて
- コンテナ間の通信が一つのSwarmで管理できる。
- そして、オプショナルなIPSecを使用することができる
- また、サービスを接続したり、しなかったりなど設計にあわせて柔軟に設定できる。

--driver overlayオプションをつけることで、オーバーレイネットワークを作成することができる。<br>

# Routing Mesh
複数のコンテナ間でのトラフィックを効率的かつ柔軟に転送するための機能。<br>
通常、オーケストレーターは、コンテナがどのノードにあるかを知っているため、トラフィックを特定のノードにルーティングします。しかし、Routing Meshを使用すると、コンテナのIPアドレスを直接指定する必要がなく、自動的にトラフィックを正しいコンテナに転送できます。

Routing Meshは、ロードバランシングやフェイルオーバー、サービスディスカバリーなど、多くのオーケストレーションタスクに役立ちます。また、アプリケーションのスケーラビリティや可用性を向上させることができます。

Swarmの場合、LinuxカーネルのIPVS（Linuxカーネルに組み込まれたロードバランサー）を使用して、Routing Meshを実装している。


# Routing Meshの実現方法
- Overlay Networkでコンテナ同士の通信をする（VIPを使用）
- それぞれのサービスにロードバランサを作成する方法（ingress networkというデフォルトの仮想ネットワークでつながっているので実現可能。）

※1つのネットワークか別々のネットワークかが大きな違い。しかし、どちらの場合でも、行われる機能としては同じ（ロードバランスして、それぞれのコンテナに振り分ける）

# Routing Meshのコネクションについての問題点
- ステートレスなロードバランサー
- OSI参照モデルのLayer3（TCP）のロードバランサ（Layer4（DNS）でないので、同じポートで複数のサイトを同じSwarmでは実現できない）

# 上記の問題点への解決策
- Nginx or HAProxyを使用する(Routing Meshの前に挟む)
- Docker Enterprise Editionを使用する（これだと、L4のWeb proxyがビルドインで存在する）

# Overlay Multiple-Host Networking
複数のホスト間での通信を仮想的に行う技術です。<br>
異なる物理的なネットワーク上にある複数のホストを同じ論理的なネットワーク上に配置することができる。<br>
この技術は、クラウドコンピューティングやデータセンターなど、多数のホストがある環境で利用されます。また、仮想化技術を使用することで、オーバーレイネットワーク上で新しい仮想マシンを追加することが容易になります。<br>

# IPVS
IPVS（IP Virtual Server）は、Linuxカーネルに組み込まれたロードバランサーです。IPVSは、ネットワークレイヤー（OSIモデルの第3層）で動作し、TCP/UDPトラフィックを分散するために使用されます。

IPVSは、クライアントからのリクエストを複数のサーバーに分散し、サーバーが実行するタスクを均等に分配することができます。IPVSは、バックエンドサーバーに対するトラフィックを効率的に転送するために、ネットワークアドレス変換（NAT）を使用します。

IPVSは、多くのロードバランシング手法をサポートしており、ラウンドロビン、ウェイト、LVS-NAT、LVS-TUN、LVS-DRなどのアルゴリズムが利用可能です。また、IPVSは、バックエンドサーバーの可用性を監視し、障害が発生した場合に自動的にトラフィックを他のサーバーに転送する機能も提供しています。

IPVSは、カーネルレベルで動作するため、通常のユーザースペースのロードバランサーと比較して高速で信頼性が高く、負荷分散に適しています。そのため、IPVSは、大規模なWebサイトやアプリケーション、クラウド環境など、高い負荷分散性能が求められる場面で広く使用されています
